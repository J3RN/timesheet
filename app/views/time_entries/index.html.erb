<p id="notice"><%= notice %></p>

<h1>Time Entries</h1>
<h4><time><%= std_date(Date.today) %></time></h4>

<br>

<div class="col-md-2">
  <%= button_to "New Entry", new_time_entry_path, method: :get, class: "btn btn-primary" %><br />
  <% if current_user.admin? %>
    <%= button_to "Export CSV", time_entries_path(format: :csv), method: :get, class: "btn btn-primary" %>

    <%= form_tag '/time_entries/report', method: :get do %>
      <%= select_tag "customer_id", options_from_collection_for_select(Customer.all, "id", "company") %>
      <%= submit_tag "Generate Report", class: "btn btn-primary" %>
    <% end %>
  <% end %>

</div>

<div class="col-md-10">
  <table class="table">
    <tbody>
      <% @time_entries.each do |entry| %>
        <tr>
          <td><b><%= entry.task.task_name %> (<%= entry.project.project_name %>)</b><br />
            <%= entry.note %></td>
          <td>
            <%= hours_duration(entry.duration / 60.0) %>
          </td>
          <% if current_user.admin? %>
            <td>
              <%= entry.user.username %>
            </td>
          <% end %>
          <td>
            <% if entry.running? %>
              <%= button_to 'Stop', stop_time_time_entry_path(entry), method: :get, class: "btn btn-primary" %>
            <% else %>
              <%= button_to 'Resume', start_time_time_entry_path(entry), method: :get, class: "btn btn-primary" %>
            <% end %>
          </td>
          <td>
            <%= button_to 'Edit', edit_time_entry_path(entry), method: :get, class: "btn" %>
          </td>
        </tr>
      <% end %>
      <tr>
        <td><b>Total</b></td>
        <td colspan='3'><%= hours_duration(@total) %></td>
      </tr>
    </tbody>
  </table>
</div>
